# پنل مدیریت وب برای بات

این پنل مدیریت وب برای مدیریت کامل بات تلگرام طراحی شده است.

## ویژگی‌ها

### داشبورد
- نمایش آمار کلی سیستم
- تعداد کاربران، حساب‌ها و تراکنش‌ها
- نمودارهای آماری
- بروزرسانی خودکار هر 30 ثانیه

### مدیریت کاربران
- مشاهده لیست تمام کاربران
- جستجو و فیلتر کاربران
- مشاهده جزئیات کاربر (حساب‌ها، تراکنش‌ها)
- قفل و باز کردن کاربران
- مشاهده دلیل قفل شدن

### مدیریت حساب‌ها
- مشاهده لیست تمام حساب‌ها
- جستجو بر اساس شماره حساب یا User ID
- فعال/غیرفعال کردن حساب‌ها
- مشاهده موجودی هر حساب

### مدیریت تراکنش‌ها
- مشاهده لیست تمام تراکنش‌ها
- فیلتر بر اساس نوع (خرید، فروش، ارسال)
- فیلتر بر اساس وضعیت (در انتظار، موفق، ناموفق)
- جستجو بر اساس شماره حساب

## نصب و راه‌اندازی

### 1. نصب وابستگی‌ها

```bash
pip install -r requirements.txt
```

### 2. تنظیم متغیرهای محیطی

در فایل `.env` متغیرهای زیر را اضافه کنید:

```env
# برای امنیت بیشتر، این کلید را تغییر دهید
WEB_SECRET_KEY=your-secret-key-here-change-in-production

# رمز عبور ادمین (پیش‌فرض: admin123)
ADMIN_PASSWORD=your-admin-password

# سایر تنظیمات موجود در .env
BOT_TOKEN=your-bot-token
DATABASE_URL=sqlite:///balancebot.db
```

### 3. اجرای پنل وب

**Windows:**
```bash
run_web.bat
```

**Linux/Mac:**
```bash
chmod +x run_web.sh
./run_web.sh
```

**یا مستقیماً:**
```bash
python -m web.app
```

### 4. دسترسی به پنل

پس از اجرا، به آدرس زیر مراجعه کنید:

```
http://localhost:5000
```

**ورود:**
- نام کاربری: `admin`
- رمز عبور: مقدار `ADMIN_PASSWORD` در فایل `.env` (پیش‌فرض: `admin123`)

## ساختار فایل‌ها

```
web/
├── __init__.py          # Package initialization
├── app.py               # Flask application اصلی
├── models.py            # مدل‌های کاربر ادمین
├── utils.py             # توابع کمکی
├── templates/           # قالب‌های HTML
│   ├── base.html
│   ├── login.html
│   ├── dashboard.html
│   ├── users.html
│   ├── accounts.html
│   └── transactions.html
└── static/              # فایل‌های استاتیک
    ├── css/
    │   └── style.css
    └── js/
        └── main.js
```

## امنیت

⚠️ **توجه:** برای استفاده در محیط production:

1. حتماً `WEB_SECRET_KEY` را تغییر دهید
2. `ADMIN_PASSWORD` را به یک رمز قوی تغییر دهید
3. از HTTPS استفاده کنید
4. سیستم احراز هویت را به دیتابیس منتقل کنید (به جای درون‌حافظه)
5. Rate limiting اضافه کنید
6. از یک سرور WSGI مانند Gunicorn استفاده کنید

## استفاده همزمان با بات

این پنل وب می‌تواند همزمان با بات تلگرام اجرا شود. هر دو از همان دیتابیس استفاده می‌کنند.

برای اجرای همزمان:
1. در یک ترمینال: `python bot.py` (اجرای بات)
2. در ترمینال دیگر: `python -m web.app` (اجرای پنل وب)

## پشتیبانی

در صورت بروز مشکل، لاگ‌ها را بررسی کنید و مطمئن شوید که:
- تمام وابستگی‌ها نصب شده‌اند
- دیتابیس در دسترس است
- پورت 5000 آزاد است
